<div class="o_assessment_test_results"><div class="o_header_with_buttons">
	#if($title)
	<h3>$r.translate("head.assessment.details")</h3>
	#end
	#if($print)
	<div class="o_button_group o_button_group_right">
		<script type="text/javascript">
		/* <![CDATA[ */ 
			function print() {
				try {
					var ww = window.open("$r.commandURI("print")", "$winid", "height=800,left=100,top=100,width=800,toolbar=no,titlebar=0,status=0,menubar=yes,location=no,scrollbars=1");
					ww.focus();
				} catch(e) {
					if(jQuery(document).ooLog().isDebugEnabled()) jQuery(document).ooLog('debug','Error when trying to dock div id::$r.getId("undck")', "org.olat.core.gui.control.generic.docking._content.docked.html");
				}
			}
		/* ]]> */
		</script>
		<a class="btn btn-default" href="javascript:print()" title="$r.translate("print")"><i class="o_icon o_icon_print"> </i> $r.translate("print")</a>	
	</div>
	#end
</div>
#if($r.visible("assessedIdentityInfos"))
	$r.render("assessedIdentityInfos")
#end
#if($testResults.metadataVisible)

<div id="o_qti_results_infos" class="clearfix">
	#if(${testResults.hasMaxScore()})
		<div id="o_qti_scoreinfo">
			<div id="o_qti_run_scoreinfo" class="col-md-2 col-sm-3">
			#if ($testResults.hasMaxScore())
	    		#if ($testResults.maxScore == "-1.0")
	  				$r.translate("question.progress.score"): $testResults.score / $r.translate("question.progress.noMaxScore")
	    		#else
	  				$r.translate("question.progress.score"): $testResults.score / $testResults.maxScore
	  			#end
			#else
				$r.translate("question.progress.score"): $testResults.score
			#end
	  		</div>
			<div id="o_qti_run_scoreprogress" class="col-md-3 col-sm-2">
				<div class="progress" style="width:100%;">
					<div class="progress-bar" role="progressbar" aria-valuenow="$testResults.score" aria-valuemin="0" aria-valuemax="$testResults.maxScore" style="width:${testResults.scorePercent}%;">
				      	<span class="sr-only">${testResults.scorePercent}%</span>
				      </div>
				</div>
			</div>
			<div class="col-md-1 col-sm-1">${testResults.scorePercent}%</div>
		</div>
	#end

	<div id="o_qti_questioninfo">
		<div id="o_qti_run_questioninfo" class="col-md-2 col-sm-3">
			$r.translate("question.progress.answered"): $testResults.numberOfAnsweredQuestions / $testResults.numberOfQuestions
		</div>
		<div id="o_qti_run_questionprogress" class="col-md-3 col-sm-2">
			<div class="progress" style="width:100%;">
				<div class="progress-bar" role="progressbar" aria-valuenow="$testResults.numberOfAnsweredQuestions" aria-valuemin="0" aria-valuemax="$testResults.numberOfQuestions" style="width:${testResults.numberOfAnsweredQuestionsPercent}%;">
			      	<span class="sr-only">${testResults.numberOfAnsweredQuestionsPercent}%</span>
			      </div>
			</div>
		</div>
		<div class="col-md-1 col-sm-1">${testResults.numberOfAnsweredQuestionsPercent}%</div>
	</div>
</div>

<div class="panel panel-default o_personal o_sel_results_details">
  	<div class="panel-heading">
 		<h4 class="panel-title"><i class="o_icon o_qtiassessment_icon"> </i> $r.translate("head.assessment.overview")</h4>
 	</div>
	<table class="table"><tbody>
		<tr>
			<th>$r.translate("results.entry.time")</th>
			<td>$r.formatDateAndTime($testResults.entryTime)</td>
		</tr>
		<tr>
			<th>$r.translate("results.end.time")</th>
			<td>$r.formatDateAndTime($testResults.endTime)</td> 
		</tr>
		<tr>
			<th>$r.translate("results.duration")</th>
			<td>$r.formatDurationInMillis($testResults.duration)</td>
		</tr>
		#if(${testResults.hasMaxScore()})
		<tr class="o_sel_assessmenttest_maxscore">
			<th>$r.translate("score.max")</th>
			<td>$testResults.maxScore</td>
		</tr>
		#end
		#if(${testResults.hasScore()})
		<tr class="o_sel_assessmenttest_score">
			<th>$r.translate("results.score.yourscore")</th>
			<td>
				<div class="col-sm-2" style='padding-left:0;'>$testResults.score</div>
				<div class="col-sm-8">
					<div class="progress" style="width:100%;">
						<div class="progress-bar" role="progressbar" aria-valuenow="$testResults.score" aria-valuemin="0" aria-valuemax="$testResults.maxScore" style="width:${testResults.scorePercent}%;">
				      		<span class="sr-only">${testResults.scorePercent}%</span>
				      	</div>
					</div>
				</div>
				<div class="col-sm-2">${testResults.scorePercent}%</div>
			</td>
		</tr>
		#end
		#if(${testResults.hasPass()})
		<tr class="o_state #if(${testResults.getPass().booleanValue()}) o_passed #elseif(!${testResults.getPass().booleanValue()}) o_failed #else o_unknown #end">
			<th>$r.translate("passed.yourpassed")</th>
			<td> 
			#if(${testResults.getPass().booleanValue()})	
				<i class="o_icon o_icon_passed"></i> 
				$r.translate("passed.yes")
			#elseif(!${testResults.getPass().booleanValue()})		
				<i class="o_icon o_icon_failed"></i> 
				$r.translate("passed.no")
			#else
				$r.translateWithPackage("org.olat.course.nodes.st", "passed.noinfo")
			#end
			</td>
		</tr>
		#end
		#if($r.isNotNull($signatureUrl))
		<tr>
			<th>$r.translate("digital.signature.download")</th>
			<td><a href="$signatureUrl" target="_blank"><i class="o_icon o_icon-fw o_icon_download"> </i> $r.translate("digital.signature.download.link")</a></td> 
		</tr>
		#end
	</tbody></table>
</div>
#end

#foreach($itemResult in $itemResults)
	#if($itemResult.metadataVisible || $r.isNotNull($itemResult.questionItem) || ${itemResult.hasInteractions()})
	<div class="panel panel-default o_personal">
	  	<div class="panel-heading">
	 		<h5 class="panel-title"><i class="o_icon $itemResult.cssClass"> </i> $r.escapeHtml($itemResult.title)</h5>
	 	</div>
	 	#if($itemResult.metadataVisible)
		<table class="table"><tbody>
			#if(!${itemResult.isSection()})
			<tr class="o_sel_assessmentitem_status">
				<th>$r.translate("results.session.status")</th>
				<td>$itemResult.sessionStatus</td> 
			</tr>
			#end
			#if(${itemResult.hasMaxScore()})
			<tr class="o_sel_assessmentitem_maxscore">
				<th>$r.translate("score.max")</th>
				<td>$itemResult.maxScore</td> 
			</tr>
			#end
			#if(${itemResult.hasScore()})
			<tr class="o_sel_assessmentitem_score">
				<th>$r.translate("results.score.yourscore")</th>
				<td>
					<div class="col-sm-2" style='padding-left:0;'>$itemResult.score</div>
					<div class="col-sm-8">
						<div class="progress" style="width:100%;">
							<div class="progress-bar" role="progressbar" aria-valuenow="$itemResult.score" aria-valuemin="0" aria-valuemax="$itemResult.maxScore" style="width:${itemResult.scorePercent}%;">
					      		<span class="sr-only">${itemResult.scorePercent}%</span>
					      	</div>
						</div>
					</div>
					<div class="col-sm-2">${itemResult.scorePercent}%</div>
				</td> 
			</tr>
			#end
			#if(${itemResult.hasPass()})
			<tr class="o_state #if(${testResults.getPass().booleanValue()}) o_passed #elseif(!${testResults.getPass().booleanValue()}) o_failed #else o_unknown #end">
				<th>$r.translate("passed.yourpassed")</th>
				<td> 
				#if(${itemResult.getPass().booleanValue()})	
					<i class="o_icon o_icon_passed"></i> 
					$r.translate("passed.yes")
				#elseif(!${itemResult.getPass().booleanValue()})		
					<i class="o_icon o_icon_failed"></i> 
					$r.translate("passed.no")
				#else
					$r.translateWithPackage("org.olat.course.nodes.st", "passed.noinfo")
				#end
				</td>
			</tr>
			#end
			#if($r.isNotEmpty($itemResult.comment))
			<tr class="o_sel_assessmentitem_comment">
				<th>$r.translate("results.comment")</th>
				<td>$r.escapeHtml($itemResult.comment)</td> 
			</tr>
			#end
			#if($r.isNotEmpty($itemResult.getSubResults()))
			<tr>
				<td colspan="2">
				#foreach($subResults in $itemResult.getSubResults())
					#if(${subResults.isCorrect()})
						<i class="o_icon o_icon-lg o_icon_qti_summary_correct"> </i>
					#elseif(${subResults.isEnded()})
						<i class="o_icon o_icon-lg $o-qti-status-ended-color"> </i>
					#else
						<i class="o_icon o_icon-lg o_icon_qti_summary_notAnswered"> </i>
					#end
				#end
				</td>
			</tr>
			#end
		</tbody></table>
		#end
	</div>
	#end
	
	#if($r.isNotNull($itemResult.questionItem)) 
		<div class="o_block_bottom clearfix"><h5>$r.translate("question")</h5>
			$r.render($itemResult.questionItem.name)
		</div>
	#end
	
	#foreach($itemInteraction in $itemResult.interactionResults)
		#if($r.isNotNull($itemInteraction.responseFormItem.name) || $r.isNotNull($itemInteraction.solutionFormItem.name))
		<div class="row #if(!$foreach.hasNext ) o_block_bottom #end">
			#if($r.isNotNull($itemInteraction.responseFormItem.name) && $r.isNotNull($itemInteraction.solutionFormItem.name))
				<div class="col-sm-6"><h5>$r.translate("response")</h5>
					$r.render($itemInteraction.responseFormItem.name)
				</div>
				<div class="col-sm-6"><h5>$r.translate("solution")</h5>
					$r.render($itemInteraction.solutionFormItem.name)
				</div>
			#elseif($r.isNotNull($itemInteraction.responseFormItem.name))
				<div class="col-sm-12"><h5>$r.translate("response")</h5>
					$r.render($itemInteraction.responseFormItem.name)
				</div>
			#else
				<div class="col-sm-12"><h5>$r.translate("solution")</h5>
					$r.render($itemInteraction.solutionFormItem.name)
				</div>
			#end
		</div>
		#end
	#end
#end

#if($printCommand)
<script type="text/javascript">
/* <![CDATA[ */ 
	jQuery(function() {
		window.focus();
		window.print();
	});
/* ]]> */
</script>
#end
</div>